REM Main
REM We want to make links from our files to all installed versions of Max
REM This does not copy the actual plugin, just the scripts


IF DEFINED ADSK_3DSMAX_x86_2012 (
	call :COPY_TO "%ADSK_3DSMAX_x86_2012%" "2012" "32
)

IF DEFINED ADSK_3DSMAX_x64_2012 (
	call :COPY_TO "%ADSK_3DSMAX_x64_2012%" "2012" "64"
)

IF DEFINED ADSK_3DSMAX_x86_2013 (
	call :COPY_TO "%ADSK_3DSMAX_x86_2013%" "2013" "32"
)

IF DEFINED ADSK_3DSMAX_x64_2013 (
	call :COPY_TO "%ADSK_3DSMAX_x64_2013%" "2013" "64"
)

IF DEFINED ADSK_3DSMAX_x86_2014 (
	call :COPY_TO "%ADSK_3DSMAX_x86_2014%" "2014" "32"
)

IF DEFINED ADSK_3DSMAX_x64_2014 (
	call :COPY_TO "%ADSK_3DSMAX_x64_2014%" "2014" "64"
)

pause
GOTO EOF

REM Copy Function
:COPY_TO

IF "%~1" == "" (
	echo "!!!!!!!!!!No Input: quitting!!!!!!!!!!!!"
	GOTO EOF
)
echo "Copying to: "
echo %*

del "%~1plugins\FabricSplice3dsmax.dlu"
del "%~1Fabric*.dll"
del "%UserProfile%\AppData\local\Autodesk\3dsMax\%~2 - %~3bit\ENU\scripts\startup\editor.ms"

mklink "%~1plugins\FabricSplice3dsmax.dlu" "%~dp0Plugin %~2\FabricSplice3dsmax.dlu"
mklink "%~1FabricCore-1.13.dll" "%FABRIC_CAPI_DIR%\lib\FabricCore-1.13.dll"
mklink "%~1FabricSplice-1.13.0.dll" "%FABRIC_SPLICE_API_DIR%\FabricSplice-1.13.0.dll"
mklink "%UserProfile%\AppData\local\Autodesk\3dsMax\%~2 - %~3bit\ENU\scripts\startup\editor.ms" "%~dp0editor.ms"

:EOF